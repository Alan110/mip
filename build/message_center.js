define("message_center",["require","observable"],function(e){function s(e,s,n){var a=((new Date).getTime()+parseInt(1e3*Math.random())).toString();s.requestData={},s.sentinel=i,s.requestData.sessionID=a,void 0!=typeof n&&(responseHandlers[a]=n),e.postMessage(s,"*")}function n(e){t||(window.addEventListener("message",function(e){a(e)},!1),t=!0),r.add(e)}function a(e){var s=e.data;if(s.sentinel==i)r.fire(e);else if(s.sentinel==d){var n=s.sessionID;responseHandlers[n]&&responseHandlers[n](e)}}responseHandlers={};var r=e("observable"),t=!1,o="__MIP__",i=o+"REQUEST",d=o+"RESPONSE";return{sendRequest:s,sendResponse:s,onMessage:n}});